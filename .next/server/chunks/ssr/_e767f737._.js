module.exports=[29171,a=>{"use strict";var b=a.i(7997),c=a.i(82248);function d({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card",className:(0,c.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",a),...d})}function e({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-header",className:(0,c.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",a),...d})}function f({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-title",className:(0,c.cn)("leading-none font-semibold",a),...d})}function g({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-description",className:(0,c.cn)("text-muted-foreground text-sm",a),...d})}function h({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-content",className:(0,c.cn)("px-6",a),...d})}a.s(["Card",()=>d,"CardContent",()=>h,"CardDescription",()=>g,"CardHeader",()=>e,"CardTitle",()=>f])},37936,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"registerServerReference",{enumerable:!0,get:function(){return d.registerServerReference}});let d=a.r(11857)},11070,a=>{"use strict";let b=(0,a.i(1269).default)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);a.s(["DollarSign",()=>b],11070)},95918,a=>{"use strict";var b=a.i(7997),c=a.i(37936),d=a.i(98310);a.i(70396);var e=a.i(73727),f=a.i(43917),g=a.i(29171),h=a.i(96942),i=a.i(82248);let j=(0,h.cva)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function k({className:a,variant:c,...d}){return(0,b.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,i.cn)(j({variant:c}),a),...d})}function l({className:a,...c}){return(0,b.jsx)("div",{"data-slot":"alert-title",className:(0,i.cn)("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",a),...c})}function m({className:a,...c}){return(0,b.jsx)("div",{"data-slot":"alert-description",className:(0,i.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",a),...c})}var n=a.i(46840),o=a.i(11070),p=a.i(1269);let q=(0,p.default)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),r=(0,p.default)("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),s=(0,p.default)("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]),t=(0,p.default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var u=a.i(95936);let v=async function(){let a=await (0,d.createClient)();await a.auth.signOut(),(0,e.redirect)("/")};async function w(){let a=await (0,d.createClient)(),{data:{user:c}}=await a.auth.getUser();c||(0,e.redirect)("/auth/login");let{data:h}=await a.from("profiles").select("*").eq("id",c.id).single();h&&"admin"===h.role||(0,e.redirect)("/dashboard");try{let c=new Date,d=c.getMonth()+1,e=c.getFullYear(),[h,i,j,k,l]=await Promise.all([a.from("rent_payments").select("amount_paid, commission_amount").eq("month",d).eq("year",e).eq("status","paid"),a.from("expenses").select("amount").gte("expense_date",`${e}-${d.toString().padStart(2,"0")}-01`).lt("expense_date",`${e}-${(d+1).toString().padStart(2,"0")}-01`),a.from("landlord_payouts").select("total_payout").eq("month",d).eq("year",e),a.from("tenants").select("*",{count:"exact",head:!0}),a.from("landlord_payouts").select("*",{count:"exact",head:!0}).eq("status","pending")]);if(h.error||i.error||j.error||k.error||l.error);else{let a=h.data||[],d=i.data||[],m=j.data||[],p={totalRentCollected:a.reduce((a,b)=>a+Number(b.amount_paid||0),0),totalCommission:a.reduce((a,b)=>a+Number(b.commission_amount||0),0),totalExpenses:d.reduce((a,b)=>a+Number(b.amount||0),0),totalPayouts:m.reduce((a,b)=>a+Number(b.total_payout||0),0),netProfit:0,totalTenants:k.count||0,pendingPayouts:l.count||0,paymentsCount:a.length,expensesCount:d.length,collectionRate:0};return p.netProfit=p.totalCommission-p.totalExpenses,p.collectionRate=p.totalTenants?Math.round(a.length/p.totalTenants*100):0,(0,b.jsxs)("div",{className:"flex min-h-svh flex-col",children:[(0,b.jsx)("header",{className:"border-b",children:(0,b.jsxs)("div",{className:"container mx-auto flex h-16 items-center justify-between px-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(n.Building2,{className:"h-6 w-6"}),(0,b.jsx)("span",{className:"text-xl font-semibold",children:"PropertyHub - Accounting"})]}),(0,b.jsxs)("nav",{className:"flex items-center gap-4",children:[(0,b.jsx)(u.default,{href:"/admin",children:(0,b.jsx)(f.Button,{variant:"ghost",children:"Admin Dashboard"})}),(0,b.jsx)(u.default,{href:"/dashboard",children:(0,b.jsx)(f.Button,{variant:"ghost",children:"Dashboard"})}),(0,b.jsx)("form",{action:v,children:(0,b.jsx)(f.Button,{variant:"ghost",type:"submit",children:"Logout"})})]})]})}),(0,b.jsx)("main",{className:"flex-1",children:(0,b.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Accounting Dashboard"}),(0,b.jsxs)("p",{className:"text-muted-foreground",children:["Financial overview for ",c.toLocaleString("default",{month:"long"})," ",e]})]}),(0,b.jsxs)("div",{className:"mb-8 grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(g.CardTitle,{className:"text-sm font-medium",children:"Total Rent Collected"}),(0,b.jsx)(o.DollarSign,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsxs)("div",{className:"text-2xl font-bold",children:["UGX ",p.totalRentCollected.toLocaleString()]}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[p.paymentsCount," payments"]})]})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(g.CardTitle,{className:"text-sm font-medium",children:"Commission Earned"}),(0,b.jsx)(q,{className:"h-4 w-4 text-green-600"})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:["UGX ",p.totalCommission.toLocaleString()]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"10% average rate"})]})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(g.CardTitle,{className:"text-sm font-medium",children:"Total Expenses"}),(0,b.jsx)(r,{className:"h-4 w-4 text-red-600"})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsxs)("div",{className:"text-2xl font-bold text-red-600",children:["UGX ",p.totalExpenses.toLocaleString()]}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[p.expensesCount," expenses"]})]})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(g.CardTitle,{className:"text-sm font-medium",children:"Net Profit"}),(0,b.jsx)(s,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(g.CardContent,{children:[(0,b.jsxs)("div",{className:`text-2xl font-bold ${p.netProfit>=0?"text-green-600":"text-red-600"}`,children:["UGX ",p.netProfit.toLocaleString()]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Commission - Expenses"})]})]})]}),(0,b.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsx)(g.CardTitle,{className:"text-base",children:"Rent Collection"}),(0,b.jsx)(g.CardDescription,{children:"Record and track rent payments"})]}),(0,b.jsx)(g.CardContent,{children:(0,b.jsx)(u.default,{href:"/admin/accounting/rent-collection",children:(0,b.jsx)(f.Button,{className:"w-full",children:"Manage Payments"})})})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsx)(g.CardTitle,{className:"text-base",children:"Landlord Accounts"}),(0,b.jsx)(g.CardDescription,{children:"View ledgers and payouts"})]}),(0,b.jsx)(g.CardContent,{children:(0,b.jsx)(u.default,{href:"/admin/accounting/landlords",children:(0,b.jsx)(f.Button,{className:"w-full",children:"View Landlords"})})})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsx)(g.CardTitle,{className:"text-base",children:"Expenses"}),(0,b.jsx)(g.CardDescription,{children:"Track company expenses"})]}),(0,b.jsx)(g.CardContent,{children:(0,b.jsx)(u.default,{href:"/admin/accounting/expenses",children:(0,b.jsx)(f.Button,{className:"w-full",children:"Manage Expenses"})})})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsx)(g.CardTitle,{className:"text-base",children:"Reports"}),(0,b.jsx)(g.CardDescription,{children:"Financial statements & exports"})]}),(0,b.jsx)(g.CardContent,{children:(0,b.jsx)(u.default,{href:"/admin/accounting/reports",children:(0,b.jsx)(f.Button,{className:"w-full",children:"View Reports"})})})]})]})]})})]})}}catch(a){}return(0,b.jsxs)("div",{className:"flex min-h-svh flex-col",children:[(0,b.jsx)("header",{className:"border-b",children:(0,b.jsxs)("div",{className:"container mx-auto flex h-16 items-center justify-between px-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(n.Building2,{className:"h-6 w-6"}),(0,b.jsx)("span",{className:"text-xl font-semibold",children:"PropertyHub - Accounting"})]}),(0,b.jsx)("nav",{className:"flex items-center gap-4",children:(0,b.jsx)(u.default,{href:"/admin",children:(0,b.jsx)(f.Button,{variant:"ghost",children:"Admin Dashboard"})})})]})}),(0,b.jsx)("main",{className:"flex-1",children:(0,b.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,b.jsxs)(k,{variant:"destructive",children:[(0,b.jsx)(t,{className:"h-4 w-4"}),(0,b.jsx)(l,{children:"Accounting System Not Set Up"}),(0,b.jsxs)(m,{className:"mt-2",children:[(0,b.jsx)("p",{className:"mb-4",children:"The accounting system requires database migration script 007 to be run first. This will create the necessary tables and columns for:"}),(0,b.jsxs)("ul",{className:"mb-4 ml-6 list-disc space-y-1",children:[(0,b.jsx)("li",{children:"Tenant management with accounting fields"}),(0,b.jsx)("li",{children:"Rent payments with month, year, and commission tracking (10%)"}),(0,b.jsx)("li",{children:"Landlord payouts and ledgers"}),(0,b.jsx)("li",{children:"Expense tracking"})]}),(0,b.jsxs)("p",{className:"font-semibold",children:["Please run the SQL script:"," ",(0,b.jsx)("code",{className:"rounded bg-muted px-2 py-1",children:"scripts/007_create_accounting_system.sql"})]})]})]})})})]})}(0,c.registerServerReference)(v,"00a9f0d27d1d746050ad45e54901616787d1efa411",null),a.s(["$$RSC_SERVER_ACTION_0",0,v,"default",()=>w],95918)},89534,a=>{"use strict";var b=a.i(95918);a.s([],75824),a.i(75824),a.s(["00a9f0d27d1d746050ad45e54901616787d1efa411",()=>b.$$RSC_SERVER_ACTION_0],89534)}];

//# sourceMappingURL=_e767f737._.js.map